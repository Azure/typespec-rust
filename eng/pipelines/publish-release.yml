trigger: none
pr: none

parameters:
- name: publish_dev
  displayName: 'Publish Dev Release only'
  type: boolean
  default: true

extends: 
  template: /eng/pipelines/templates/stages/1es-redirect.yml
  parameters:
    stages:
    - stage: Release

      variables: 
        - template: /eng/pipelines/templates/variables/image.yml
        - name: TypeSpecRustPkgDir
          value: $(System.DefaultWorkingDirectory)/packages/typespec-rust

      jobs:
        - job: Release 
          pool:
            name: $(LINUXPOOL)
            image: $(LINUXVMIMAGE)
            os: linux

          steps:
            - template: /eng/pipelines/templates/steps/set-env.yaml

            - template: /eng/pipelines/templates/steps/build-test.yaml
            - template: /eng/pipelines/templates/steps/publish-release.yaml
              parameters:
                PackagePath: "typespec-rust"
                PackageFileName: "azure-tools-typespec-rust"
                ReleaseName: "TypeSpec emitter for Rust v$currentVersion"
                ReleaseNotes: "TypeSpec emitter for Rust"
                PublishDevVersion: ${{ parameters.publish_dev }}
